# Проект 1 (Анализ данных с временной структурой)
**Для установки зависимостей:**
1. Через poetry (использовался при разработке):
* Установить poetry
* Создать виртуальное окружение
* В корневой папке репозитория: poetry install
2. Через файл requirements.txt
* В корневой папке репозитория: pip install -r requirements.txt


**Выполнены все требования к модели:**
1. **Выбор оптимизируемой метрики должен быть основан на потребностях бизнеса:** Сначала она определяет, где согласно прогнозам выгодно инвестировать, затем считает доходность от инвестиций (если прогноз положителен, то происходит инвестирование средств по ставке daytime_yield, потом из фактических доступных средств вычитается сумма прогноза для коррекции остатка средств после инвестиций. Дальше если фактическое сальдо положительное, то они размещаются на ночь по ставке overnight_yield. Если сальдо отрицательное, то происходит заем по ставке borrow_rate. В самом конце вычисляется общая прибыль, суммируя доходность от всех инвестиционных операций за день. См. BusinessSimulation в metric.py.
2. **Модель может использовать внешние факторы:** Было сгенерировано, собрано и применено большое количество внешних признаков. Лаги, статистики, макроэкономические факторы и налоговые дни и т. д. Их описание, сбор и анализ содержится в ноутбуках Features_generation.ipynb и Dataset_overview.ipynb.
3. **Модель должна иметь модуль отбора признаков. Метод отбора должен быть болеее стабильным относительно альтернатив. Сравнение должно быть проведено минимум с одним методом из каждой категории: встроенные, оберточные и фильтрационные. При этом как минимум одна из альтернатив должа исследовать нелинейную зависимость**: Реализовано 3 оберточных, 2 встроенных и 1 фильтрационный метод. Оберточный и встроенный исследуют нелинейные зависимости. Стабильность оценивается по кросс-валидации. См. Gradient_boosting_model.ipynb.
4. **Модель должна автоматически подбирать гиперпараметры, оптимизируя целевую метрику**: Optuna + реализованая целевая бизнес метрика. См. Gradient_boosting_model.ipynb. Подобрана лучшая модель с точки зрения бизнес метрики и сохранена в data/artifacts/catboost_regressor.cbm.
5. **При подборе модели обязательно нужно исследовать возможность применения авторегрессионных моделей**: Модель SARIMA. См. Autoregressive_model.ipynb.
6. **Ошибка прогноза составляет не более 0.42 в абсолютном значении** во всех построенных моделях (авторегрессия и градиентный бустинг). В качестве горизонта прогноза была выбрана out of time выборка за 2021 год.
7. **Метод выявления разладок:** Метод CUSUM. См. change_point.py.
8. **Частота калибровки:** Модель можно переобучать при возникновении разладки, найденной методом CUSUM, код рекалибровки в validation.py функция get_time_series_cv_score с параметром return_calibrated_model=True. Частота калибровки модели проверена на time series cross-validation.
9. На реальных данных путем экспертной оценки был выбран период дообучения в полгода.

_Дополнительные обоснования и комментарии по выполнению работы находятся в ноутбуках_
